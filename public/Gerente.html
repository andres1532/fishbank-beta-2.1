<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerente</title>

    <link rel="stylesheet" href="/css/Gerente.css" type="text/css" />
    <link rel="stylesheet" href="/css/timer.css" type="text/css" />
    <link rel="stylesheet" href="/css/chat.css" type="text/css" />
    <link rel="stylesheet" href="/css/tabla.css" type="text/css" />
    <link rel="stylesheet" href="/css/menu.css" type="text/css" />
    <link rel="stylesheet" href="/css/dropdown.css" type="text/css" />
    <link rel="stylesheet" href="css/grafico.css" type="text/css" />



    <!--aqui inician los scripts del chat-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
    <link rel="stylesheet" href="/css/style.css" />


    <script src="https://cdnjs.cloudflare.com/ajax/libs/qs/6.9.2/qs.min.js" integrity="sha256-TDxXjkAUay70ae/QJBEpGKkpVslXaHHayklIVglFRT4=" crossorigin="anonymous"></script>
    <script src="/socket.io/socket.io.js"></script>

</head>

<body>

    <!--aqui va el header-->
    <header class="encabezado">
        <img class="uao-2" src="/imagenes/UAO2.svg">
        <img class="usericon" src="/imagenes/user.svg">
        <p> </p>
        <!-- OJO!!!   AQUI TIENE QUE IR EL NOMBRE Y EL CARGO!!-->

        <a class="sesionIcon" href="index.html"> <img src="/imagenes/Cerrar sesiÃ³n.svg"></a>
    </header>

    <!--aqui comienza la parte de los iconos-->


    <div class="icono">
        <div class="sub-icono">
            <div class="wrapflex-tempo">
                <div class="timeIcon">
                    <img class="time" src="/imagenes/clock.svg">
                </div>
                <div class="tiempo">
                    <label id="minutes">00</label>
                    <label id="colon">:</label>
                    <label id="seconds">00</label>
                </div>
            </div>
            <div class="wrapflex-dinero">
                <div class="moneyIcon">
                    <img class="money" src="imagenes/money.svg">
                </div>
                <div>
                    <label id=dinero>$500</label>
                </div>
            </div>
        </div>
    </div>

    <!--aqui inicia el chat-->

    <div class="chat-container" style="float:right;">
        <header class="chat-header">

            <a href="index.html" class="btn-salir">Leave Room</a>
        </header>
        <main class="chat-main">

            <div class="chat-sidebar">
                <h3><i class="fas fa-comments"></i> Room Name:</h3>
                <h2 id="room-name"></h2>
                <h3><i class="fas fa-users"></i> Users</h3>
                <ul id="users"></ul>
            </div>

            <div class="chat-messages"></div>

        </main>
        <div class="chat-F-container">
            <form id="chatF">
                <input id="msg" type="text" placeholder="Enter Message" autocomplete="off" />
                <button class="btn-enviar"><i class="fas fa-paper-plane"></i> Send</button>
            </form>

            <!-- esto es para enviar dinero-->
            <form id="enviar-form">
                <input id="cantidad2" type="number" placeholder="Envia un valor" required autocomplete="off" />

                <button class="btn"><i class="fas fa-paper-plane"></i></button>
            </form>
        </div>



    </div>
    </div>




    <!--aqui termina el chat-->



    <!--aqui comienzas las graficas-->

    <div class="graficas">
        <div class="flexwrap-2">
            <div class="flexwrap-1">
                <canvas id="lineChart1" style="background-color: #787878"></canvas>
                <canvas id="lineChart2" style="background-color: #787878"></canvas>

            </div>


        </div>

    </div>

    <canvas id="lineChart3" style="background-color: #787878"></canvas>
    <canvas id="lineChart4" style="background-color: #787878"></canvas>
    <canvas id="lineChart5" style="background-color: #787878"></canvas>





    <script src="/js/mainGerente.js"></script>
    <script src="/socket.io/socket.io.js" charset="utf-8"></script>

    <script src="/js/timer.js" charset="utf-8"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
    <script src="js/grafico.js"></script>
    <script >
        const express = require('express')
const router = express.Router()
const Jugador = require('../model/jugador')

//getting all
router.get('/', async(req, res) => {
    try {
        const jugadores = await Jugador.find()
        res.json(jugadores)
    } catch (err) {
        res.status(500).json({ message: err.message })
    }

});

//get one
router.get('/:id', getJugador, (req, res) => {
    res.json(res.jugador)
});


//post one
router.post('/', async(req, res) => {
    console.log(req.body.username);
    const jugador = new Jugador({
        username: req.body.username,
        room: req.body.room
    })
    try {
        const newJugador = await jugador.save()
        res.status(201).json(newJugador)
    } catch (err) {
        res.status(400).json({ message: err.message })
    }
    res.render('public/Gerente', {
        username: jugador.username,
        room: jugador.room
    });
    res.end();
});

//update one
router.patch('/:id', getJugador, async(req, res) => {
    if (req.body.username != null) {
        res.jugador.username = req.body.username
    }
    if (req.body.room != null) {
        res.jugador.room = req.body.room
    }
    try {
        const updatedJugador = await res.jugador.save()
        res.json(updatedJugador)
    } catch (err) {
        res.status(400).json({ message: err.message })
    }
})

//delete one
router.delete('/:id', getJugador, async(req, res) => {
    try {
        await res.jugador.remove()
        res.json({ message: 'Deleted user' })
    } catch (err) {
        res.status(500).json({ message: err.message })
    }
})


//
async function getJugador(req, res, next) {
    let jugador
    try {
        jugador = await Jugador.findById(req.params.id)
        if (jugador == null) {
            return res.status(404).json({ message: 'Cannot find jugador' })
        }
    } catch (err) {
        return res.status(500).json({ message: err.message })
    }

    res.jugador = jugador
    next()
}

module.exports = router

    </script>



</body>

</html>